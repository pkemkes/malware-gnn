import os
from learning.trainer import Trainer, TrainerConfig


def main():
    # some parameters in the config are not necessary for training, but need to be set due to the design of the class
    config = TrainerConfig(True, 2, 1.4, 1e-05, 1e-05, 0.2, os.path.join("data", "binary"),
                           ["command_line", "http_request", "registry_entry"])
    trainer = Trainer(config)
    # choose the best model based on the validation loss and load it
    best_epoch = 123
    trainer.logger(best_epoch)
    trainer.test()
    # use a custom distribution in the testset
    trainer.test([0.9, 0.1])


if __name__ == '__main__':
    main()
